combined_controller_manager:
  ros__parameters:
    update_rate: 500  # Hz

    panda_arm_controller:
      type: joint_trajectory_controller/JointTrajectoryController

    hand_controller:
      type: position_controllers/GripperActionController

    panda_joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster
      
    # --- PBA Controllers ---
    pba_joint_state_broadcaster:
      type: joint_state_broadcaster/JointStateBroadcaster

    pba_velocity_controller: # Renamed for clarity
      type: velocity_controllers/JointGroupVelocityController

# --------------------------------------------------------------------------------------------------
# Controller configurations at ROOT level (not nested)
# --------------------------------------------------------------------------------------------------

# --- Panda Configurations ---
panda_joint_state_broadcaster:
  ros__parameters:
    state_publish_rate: 100.0
    joints:
      - panda_joint1
      - panda_joint2
      - panda_joint3
      - panda_joint4
      - panda_joint5
      - panda_joint6
      - panda_joint7

panda_arm_controller:
  ros__parameters:
    joints:
      - panda_joint1
      - panda_joint2
      - panda_joint3
      - panda_joint4
      - panda_joint5
      - panda_joint6
      - panda_joint7
    command_interfaces:
      - position
    state_interfaces:
      - position
      - velocity
      - effort
    allow_nonzero_velocity_at_trajectory_end: true
hand_controller:
  ros__parameters:
    joint: panda_finger_joint1

# --- PBA Configurations ---
pba_joint_state_broadcaster:
  ros__parameters:
    state_publish_rate: 100.0
    joints:
      - pb_starter_joint
      - pb_first_joint  
      - pb_second_joint
      - pb_third_joint

pba_velocity_controller:
  ros__parameters:
    joints:
      - pb_starter_joint
    interface_name: velocity
    state_interfaces:
      - position
      - velocity
      - effort
